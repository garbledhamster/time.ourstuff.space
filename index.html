<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b1020" />
  <title>Ticket Time Tracker</title>

  <!-- FullCalendar (global bundle) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css">
  <!-- App styles -->
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <div class="app">
    <!-- Top bar -->
    <header class="topbar">
      <div class="brand pill" title="Ticket Time Tracker">
        <span aria-hidden>⏱️</span>
        <span>Ticket Time</span>
      </div>

      <button class="btn mobileOnly" id="openDrawerBtn" title="Open ticket drawer">☰ Tickets</button>

      <div class="spacer"></div>

      <div class="viewGroup">
        <button class="btn" id="prevBtn" title="Previous">←</button>
        <button class="btn" id="todayBtn" title="Today">Today</button>
        <button class="btn" id="nextBtn" title="Next">→</button>

        <span class="divider"></span>

        <button class="btn" data-view="timeGridDay">Day</button>
        <button class="btn" data-view="timeGridWeek">Week</button>
        <button class="btn" data-view="dayGridMonth">Month</button>
        <button class="btn" data-view="listWeek">List</button>
      </div>
    </header>

    <div class="errorBanner" id="errorBanner" role="alert" aria-live="polite"></div>

    <main class="main">
      <!-- Tickets panel (desktop sidebar, mobile drawer) -->
      <div class="drawerOverlay" id="drawerOverlay"></div>

      <aside class="ticketsPanel" id="ticketsPanel" aria-label="Tickets panel">
        <div class="ticketsHeader">
          <div class="ticketsTitleRow">
            <h2>Tickets</h2>
            <div class="smallMuted">
              <span id="ticketsCount">0</span>
              <button class="btn smallBtn" id="closeDrawerBtn">Close</button>
            </div>
          </div>

          <div class="fieldRow">
            <input class="input" id="ticketKeyInput" placeholder="Ticket ID or URL (e.g. 12345 or Zendesk link)" />
          </div>
          <div class="fieldRow">
            <input class="input" id="ticketTitleInput" placeholder="Title" />
          </div>
          <div class="fieldRow">
            <input class="input" id="ticketClientInput" placeholder="Client" />
          </div>

          <div class="fieldRow">
            <button class="btn primary" id="addTicketBtn">+ Add ticket</button>
            <button class="btn" id="exportBtn" title="Export time logs to CSV">Export CSV</button>
            <button class="btn" id="importBtn" title="Import Zendesk tickets from CSV">Import CSV</button>
            <input class="hiddenInput" id="importInput" type="file" accept=".csv,text/csv" />
          </div>

          <div class="fieldRow" id="statusFilters" style="gap:12px; flex-wrap:wrap;">
            <span class="smallMuted">Status:</span>
            <label class="smallMuted">
              <input type="checkbox" name="ticketStatusFilter" value="open" checked />
              Open
            </label>
            <label class="smallMuted">
              <input type="checkbox" name="ticketStatusFilter" value="in-progress" checked />
              In-Progress
            </label>
            <label class="smallMuted">
              <input type="checkbox" name="ticketStatusFilter" value="closed" />
              Closed
            </label>
          </div>

          <div class="fieldRow" id="clientFilters" style="gap:12px; flex-wrap:wrap;">
            <span class="smallMuted">Client:</span>
            <select class="input" id="clientFilterSelect" aria-label="Filter by client"></select>
          </div>

          <div class="fieldRow" style="margin-bottom:0;">
            <input class="input" id="ticketSearchInput" placeholder="Search tickets..." />
          </div>

          <div class="themeSection">
            <div class="label">Theme</div>
            <select class="input" id="themePresetSelect"></select>
            <div class="themeCustom" id="themeCustomFields"></div>
          </div>
        </div>

        <div class="ticketList" id="ticketList"></div>
      </aside>

      <!-- Calendar area -->
      <section class="calendarWrap" aria-label="Calendar area">
        <div class="calendarCard">
          <div id="calendar"></div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal: edit time log -->
  <div class="modalOverlay" id="modalOverlay" role="dialog" aria-modal="true" aria-label="Edit time log">
    <div class="modal">
      <div class="modalHeader">
        <div>
          <h3 id="modalTitle">Edit time log</h3>
          <div class="sub" id="modalSub">—</div>
        </div>
        <button class="btn" id="closeModalBtn">✕</button>
      </div>

      <div class="modalBody">
        <div class="grid2">
          <div>
            <div class="label">Start</div>
            <input class="input" id="modalStart" type="datetime-local" />
          </div>
          <div>
            <div class="label">End</div>
            <input class="input" id="modalEnd" type="datetime-local" />
          </div>
        </div>

        <div>
          <div class="label">Notes</div>
          <textarea class="input" id="modalNotes" placeholder="What did you do? (saved locally)"></textarea>
        </div>

        <div class="smallMuted">
          Tip: Drag/resize blocks. Double-click (or double-tap) a block to edit.
        </div>
      </div>

      <div class="modalFooter">
        <button class="btn danger" id="deleteEventBtn">Delete block</button>
        <div class="modalFooterRight">
          <button class="btn" id="cancelModalBtn">Cancel</button>
          <button class="btn primary" id="saveModalBtn">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>

  <!-- App (ES Modules) -->
  <script type="module" src="./js/app.js"></script>
</body>
</html>
